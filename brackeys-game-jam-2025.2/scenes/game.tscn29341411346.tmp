[gd_scene load_steps=8 format=3 uid="uid://sw3jco1ktcgr"]

[ext_resource type="Script" uid="uid://b0ykv41mhvrlf" path="res://scripts/managers/GameManager.gd" id="1_uwrxv"]
[ext_resource type="Script" uid="uid://bfs12xa3a3fq0" path="res://scripts/scores/Deck.gd" id="4_iywne"]
[ext_resource type="Script" uid="uid://dgw01n4gj8l0g" path="res://scripts/scores/PlayerHand.gd" id="5_p57ef"]
[ext_resource type="PackedScene" uid="uid://b3r1ut20x166n" path="res://scenes/value_bar.tscn" id="5_u5sy4"]
[ext_resource type="Script" uid="uid://drugubs3rpa4o" path="res://scripts/scores/DealerHand.gd" id="6_u5sy4"]
[ext_resource type="Script" uid="uid://cdofl2vwa5ues" path="res://scripts/managers/BiscuitManager.gd" id="7_u5sy4"]

[sub_resource type="GDScript" id="GDScript_p57ef"]
script/source = "extends Node2D

#const COLLISION_MASK_DECK_CARD = 1
#const COLLISION_MASK_PLAYED_CARD = 2
#
#var screen_size
#var card_being_dragged
#var is_hovering_on_card
#
#func _ready() -> void:
	#screen_size = get_viewport_rect().size
#
#func _process(delta: float) -> void:
	#if card_being_dragged:
		#var mouse_pos = get_global_mouse_position()
		#card_being_dragged.position = Vector2(clamp(mouse_pos.x, 0, screen_size.x), 
			#clamp(mouse_pos.y, 0, screen_size.y))
#
#func _input(event):
	#if event is InputEventMouseButton and event.button_index == MOUSE_BUTTON_LEFT:
		#if event.pressed:
			#var card = raycast_check_for_card()
			#if card:
				#var player_card = get_parent().player_hit()
				#add_child(player_card)
#
#func connect_card_signals(card):
	#card.connect(\"hovered\", on_hovered_over_card)
	#card.connect(\"hovered_off\", on_hovered_off_card)
#
#func on_hovered_over_card(card):
	#if !is_hovering_on_card:
		#is_hovering_on_card = true
		#highlight_card(card, true)
#
#func on_hovered_off_card(card):
	#if !card_being_dragged:
		#highlight_card(card, false)
		#
		## check if hovered off card straight onto another card
		#var new_card_hovered = raycast_check_for_card()
		#if new_card_hovered:
			#highlight_card(new_card_hovered, true)
		#else:
			#is_hovering_on_card = false
#
#func highlight_card(card, hovered):
	#if hovered:
		#card.scale = Vector2(1.1, 1.1)
		#card.z_index = 2
	#else:
		#card.scale = Vector2(1, 1)
		#card.z_index = 1
#
#func raycast_check_for_card():
	#var space_state = get_world_2d().direct_space_state
	#var parameters = PhysicsPointQueryParameters2D.new()
	#
	#parameters.position = get_global_mouse_position()
	#parameters.collide_with_areas = true
	#parameters.collision_mask = COLLISION_MASK_DECK_CARD
	#
	#var result = space_state.intersect_point(parameters)
	#
	#if result.size() > 0:
		#return get_card_with_highest_z_index(result)
	#return null
#
#func get_card_with_highest_z_index(cards):
	#var highest_z_card = cards[0].collider.get_parent()
	#var highest_z_index = highest_z_card.z_index
	#
	#for i in range(1, cards.size()):
		#var current_card = cards[i].collider.get_parent()
		#if current_card.z_index > highest_z_index:
			#highest_z_card = current_card
			#highest_z_index = current_card.z_index
	#
	#return highest_z_card
"

[node name="Game" type="Node2D"]
script = ExtResource("1_uwrxv")

[node name="CardManager" type="Node2D" parent="."]
script = SubResource("GDScript_p57ef")

[node name="Deck" type="Node2D" parent="."]
script = ExtResource("4_iywne")

[node name="PlayerHand" type="Node2D" parent="."]
script = ExtResource("5_p57ef")

[node name="PlayerBar" parent="." instance=ExtResource("5_u5sy4")]
position = Vector2(199, 443)

[node name="DealerHand" type="Node2D" parent="."]
script = ExtResource("6_u5sy4")

[node name="DealerBar" parent="." instance=ExtResource("5_u5sy4")]
position = Vector2(199, 161)

[node name="BiscuitManager" type="Node2D" parent="."]
script = ExtResource("7_u5sy4")

[node name="UI" type="CanvasLayer" parent="."]

[node name="Hit" type="Button" parent="UI"]
offset_left = 449.0
offset_top = 580.0
offset_right = 563.0
offset_bottom = 630.0
theme_override_font_sizes/font_size = 22
text = "HIT"

[node name="Stand" type="Button" parent="UI"]
offset_left = 579.0
offset_top = 580.0
offset_right = 698.0
offset_bottom = 630.0
theme_override_font_sizes/font_size = 22
text = "STAND"

[node name="Reset" type="Button" parent="UI"]
offset_left = 15.0
offset_top = 19.0
offset_right = 115.0
offset_bottom = 70.0
theme_override_font_sizes/font_size = 20
text = "RESET"

[node name="PlayerScore" type="RichTextLabel" parent="UI"]
visible = false
offset_left = 90.0
offset_top = 528.0
offset_right = 322.0
offset_bottom = 610.0
theme_override_font_sizes/normal_font_size = 45
text = "Player: #"
horizontal_alignment = 1
vertical_alignment = 1

[node name="DealerScore" type="RichTextLabel" parent="UI"]
visible = false
offset_left = 90.0
offset_top = 191.0
offset_right = 322.0
offset_bottom = 262.0
theme_override_font_sizes/normal_font_size = 45
text = "Dealer: #"
horizontal_alignment = 1
vertical_alignment = 1

[node name="RoundMessage" type="RichTextLabel" parent="UI"]
offset_left = 430.0
offset_top = 275.0
offset_right = 711.0
offset_bottom = 334.0
theme_override_font_sizes/normal_font_size = 40
text = "Message"
horizontal_alignment = 1
vertical_alignment = 1

[node name="BiscuitSlot" type="Node2D" parent="UI"]
position = Vector2(963, 610)

[node name="BiscuitButton" type="Button" parent="UI"]
offset_left = 1001.0
offset_top = 19.0
offset_right = 1130.0
offset_bottom = 53.0
text = "Produce Cookie"

[node name="BiscuitDescription" type="RichTextLabel" parent="UI"]
offset_left = 857.0
offset_top = 394.0
offset_right = 1073.0
offset_bottom = 532.0
theme_override_font_sizes/normal_font_size = 16
text = "BISCUIT DESCRIPTION"
horizontal_alignment = 1
vertical_alignment = 1

[connection signal="pressed" from="UI/Hit" to="." method="_on_hit_pressed"]
[connection signal="pressed" from="UI/Stand" to="." method="_on_stand_pressed"]
[connection signal="pressed" from="UI/Reset" to="." method="_on_reset_pressed"]
[connection signal="pressed" from="UI/BiscuitButton" to="." method="_on_biscuit_button_pressed"]
